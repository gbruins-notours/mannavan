run.config:
  engine: nodejs
  engine.config:
    runtime: nodejs-10.4
    python_version: python-2.7
    dep_manager: npm

  extra_packages:
    - nginx

  extra_steps:
    - npm install

  cache_dirs:
    - node_modules

  # Enable filesystem watcher
  fs_watch: true


data.db:
  image: nanobox/postgresql:9.6


deploy.config:
  before_live:
    web.main:
      - npm run knex:migrate


web.main:
  start:
    nginx: nginx -c /app/nanobox_config/nginx.conf
    node: npm start
  writable_dirs:
    - tmp
    - logs
